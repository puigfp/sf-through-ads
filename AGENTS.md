# Agent Guidelines

## Planning Mode

When asked to "plan," create/iterate on a markdown plan in `plans/YYYYMMDDHHMM-plan-name.md` (24h format). Ask clarifying questions until the plan is detailed enough for another agent to execute without human input. Use date command to generate date.

## Execution mode

When executing a plan, add a new "implementation notes" section at the end with issues the plan didn't anticipate and the solutions you went with.

## Maintaining This File

Update this file with any project knowledge that would help future agents.

---

# Project: SF Through Ads

A static Instagram-like website showcasing unique advertisements from San Francisco.

## Tech Stack

- **Next.js 15** (App Router) + **React 19** + **TypeScript 5.7**
- **Tailwind CSS v4**
- **pnpm** as package manager
- **mise** for tool versioning (Node.js 22, pnpm 9)

## Key Commands

```bash
pnpm dev                        # Start dev server
pnpm build                      # Build for production
pnpm import-images <folder>     # Import images from a folder
```

## Secret Management

Uses **dotenvx** for encrypted secrets:
- `.env` - Encrypted secrets file (committed to git)
- `.env.keys` - Decryption keys (**NEVER commit**, gitignored)

To add/update secrets:
```bash
pnpm dotenvx set OPENAI_API_KEY "sk-..."
```

## Image Conventions

Images stored in `public/images/`:
- `001.jpg` - Full image (original aspect ratio)
- `001_thumbnail.jpg` - 1:1 AI-cropped thumbnail for grid

Original files archived in `originals/` (kept in repo).

## Image Manifest

`src/data/images.yaml` contains metadata for all images:
- `ai_generated_alt_text` - Auto-generated by import script (for accessibility)
- `description` - Manual field for sarcastic comments (human-written)

## Project Structure

```
src/
├── app/                    # Next.js App Router pages
│   ├── image/[id]/         # Image permalink
│   └── feed.xml/           # RSS feed endpoint
├── components/             # React components
├── hooks/                  # Custom React hooks
├── lib/
│   ├── config.ts           # Site constants (name, URL, etc.)
│   └── images.ts           # Image data utilities
└── data/
    └── images.yaml         # Image manifest
scripts/
└── import-images.ts        # Image import script
```

## UI Design

- **Grid view:** Light background, 1:1 square thumbnails
- **Slideshow:** Dark overlay, original aspect ratio, film-style date stamp